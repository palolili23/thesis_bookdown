# 2. Statins --------------------------------------------------------------

## 2.1 Table 1 -------------------------------------------------------------

table2.1 <-
  tibble::tribble(
    ~ "Section",
    ~ "Target trial protocol",
    ~ "Emulation using observational data",
    "Eligibility criteria",
    "Age 55 - 80 years at enrollment,
    no statin prescription in the previous 2 years, 
    known to be dementia free, MMSE >=26 at enrollment;
    cholesterol, BMI and SBP measurement at enrollment",
    "Same, except MMSE which is measured within the previous 3 years",
    "Treatment strategies",
    "1. Initiate statin therapy at baseline and remain on it during the follow-up unless serious illnes occurs <br>
     2. Refrain from taking statin therapy during the follow-up unless serious illness occurs",
    "Same",
    "Randomized assignment",
    "Random assignment to either strategy at baseline",
    "Participants are assumed to be randomly assigned at
baseline within levels of sex, educational attainment, age,
calendar year, smoking status, MMSE, BMI, APOE-Îµ4 carrier status, cholesterol, SBP, stroke, smoking status,
diabetes, cancer, heart disease (defined as any history of
atrial fibrillation, heart failure, myocardial infarction or
revascularization), and other medication",
"Start/End of follow-up",
"From baseline until dementia dx, death, or loss to follow-up (10 years without an MMSE measurement), or January 1st, 2015, which ever happened first",
"Same",
"Outcome",
"Dementia (Death as a censoring event),
     Composite outcome: dementia or death", 
"Same",
"Causal contrast",
"Modified intention-to-treat. 
    Per-protocol effect",
"Same",
"Analysis plan",
"Modified intention-to-treat analysis
    Per-protocol analysis",
"Same modified intention-to-treat analysis, 
    except that estimates are adjusted for baseline variables.
    Same per-protocol analysis, except tat time since most recent MMSE measurement 
    and time since most recent cholesterol measurement are included as baseline
    covariates",
  )

# rio::export(table2.1, here::here("tables", "table2.1.RData"))

legend2.1 <- "Serious illness defined as cancer or heart disease. Following a serious illness, participants may or may not take statin therapy,
as guided by their physicians"


## 2.2 Table 2 ---------------------------------------------------------------

table2.2 <- tibble::tribble(
  ~"Characteristic",
  ~"Non-initiators 232,904 person-trials",
  ~"Initiators 622 person-trials",
  "Male (%)", "43.0%", "45.7%",
  "Age, mean years (SD)", "69.4 (5.6)", "69.4 (5.0)",
  "MMSE, mean score (SD)", "28.3 (1.2)", "28.2 (1.3)",
  "Body mass index, mean (SD)", "27.0 (3.9)", "27.8 (4.4)",
  "Highest educational attainment (%)", NA, NA,
  "Primary", "9.7%",   "9.5%",
  "Lower/intermediate general or lower vocational", "43.7%","44.7%",
  "Intermediate vocational or higher general","31.8%","33.0%", 
  "Higher vocational or university", "13.7%","12.1%",
  "Unknown","1.2%", "0.8%",
  "APOE-e4 carrier", NA, NA,
  "Yes","25.8%","28.3%",
  "No","70.2%","66.4%",
  "Missing","4.0%","5.3%",
  "Total cholesterol, mean mmol/L (SD)","6.01 (1.01)","6.49 (1.15)",
  "Total cholesterol < 5.2 mmol/L (%)","20.5%","14.3%",
  "Total cholesterol 5.2-6.2 mmol/L (%)","39.9%","26.5%",
  "Total cholesterol >6.2 mmol/L (%)","39.6%","59.2%",
  "Systolic blood pressure, mmHg (SD)", "142.7 (20.9)", "147.5 (21.5)",
  "Smoking status (%)", NA, NA,
  "Never","30.9%","24.9%",
  "current or former","66.9%","72.8%",
  "Missing", "2.3%", "2.3%",
  "History of heart disease* (%)", "9.0%", "19.1%",
  "History of stroke (%)", "1.8%", "7.7%",
  "History of cancer (%)", NA, NA,
  "No", "92.5%", "93.6%",
  "Yes",  "5.8%",  "5.1%",
  "Missing",  "1.7%",  "1.3%",
  "History of diabetes (%)", NA, NA,
  "No","93.5%","86.2%",
  "Yes", "4.0%","11.6%",
  "Missing", "2.5%", "2.4%",
  "Current use of other prescription drugs (%)", NA, NA,
  "Antihypertensives","0.8", "0.8%",
  "Diuretics","11.1%", "17.9%",
  "Beta-blockers", "15.7%", "29.7%",
  "Calcium antagonists", "6.0%", "14.8%",
  "RAAS inhibitors", "12.0%", "24.8%",
  "Other lipid lowering drugs", "0.5%", "1.6%",
  "NSAIDs", "7.3%", "8.0%",
  "Psychotropics**", "12.0%", "15.0%",
  "Aspirin", "11.5%", "30.7%")

legend2.2 <- "* Defined as any history of atrial fibrillation, heart failure, myocardial infarction or 
revascularization"
legend2.22 <- "**Defined as antidepressants, antipsychotics, or benzodiazepines"

# rio::export(table2.2, here::here("tables", "table2.2.RData"))

## 2.3 Table 3 ------------------------------------------------------------

# table3 <- tibble::tribble(
#                   ~`5-year.risk.of.dementia`,  ~No statins,   ~`2.8.(2.6,.3.2)`, ~`0.0.(reference)`,   ~`2.9.(2.6,.3.2)`,   ~`2.8.(2.5,.3.2)`,   ~`0.0.(reference)`,
#                    "5-year risk of dementia",    "Statins",    "2.4 (1.5, 3.3)", "-0.4 (-1.3, 0.5)",    "2.2 (1.1, 3.3)",    "1.8 (0.7, 3.2)",   "-1.1 (-2.2, 0.5)",
#                   "10-year risk of dementia", "No statins",    "8.6 (7.9, 9.4)",  "0.0 (reference)",    "8.7 (7.9, 9.6)",    "8.7 (7.8, 9.7)",    "0.0 (reference)",
#                   "10-year risk of dementia",    "Statins",   "8.5 (6.2, 10.5)", "-0.1 (-2.3, 1.8)",   "7.3 (4.4, 10.2)",   "6.6 (3.4, 10.6)",   "-2.2 (-5.2, 1.6)",
#              "5-year risk of dementia/death", "No statins", "11.1 (10.6, 11.8)",  "0.0 (reference)", "11.3 (10.8, 11.9)", "11.2 (10.6, 11.8)",    "0.0 (reference)",
#              "5-year risk of dementia/death",    "Statins",  "10.7 (8.9, 12.8)", "-0.4 (-2.2, 1.4)",  "10.4 (8.2, 13.0)",   "8.5 (5.4, 11.1)",   "-2.7 (-5.3, 0.1)",
#             "10-year risk of dementia/death", "No statins", "26.0 (24.9, 27.1)",  "0.0 (reference)", "26.3 (25.2, 27.3)", "26.1 (24.8, 27.3)",    "0.0 (reference)",
#             "10-year risk of dementia/death",    "Statins", "26.3 (23.1, 29.3)",  "0.3 (-2.7, 3.3)", "25.0 (21.0, 28.8)", "21.0 (15.6, 25.7)", "-5.1 (-10.5, -1.1)",
#                                           NA,           NA,                  NA,                 NA,                  NA,                  NA,                   NA
#             )


# 2.4 supplementary table -------------------------------------------------

table2e1 <- tibble::tribble(
  ~"Trial.number", ~"Calendar.month", ~"Participants", ~"Initiators",
  1L,        "Jan-93",          105L,          0L,
  2L,        "Feb-93",          119L,          0L,
  3L,        "Mar-93",          121L,          0L,
  4L,        "Apr-93",          172L,          0L,
  5L,        "May-93",          246L,          0L,
  6L,        "Jun-93",          352L,          1L,
  7L,        "Jul-93",          474L,          1L,
  8L,        "Aug-93",          564L,          0L,
  9L,        "Sep-93",          687L,          1L,
  10L,        "Oct-93",          825L,          0L,
  11L,        "Nov-93",          887L,          0L,
  12L,        "Dec-93",         1064L,          0L,
  13L,        "Jan-94",         1240L,          0L,
  14L,        "Feb-94",         1382L,          0L,
  15L,        "Mar-94",         1558L,          2L,
  16L,        "Apr-94",         1634L,          0L,
  17L,        "May-94",         1744L,          1L,
  18L,        "Jun-94",         1795L,          2L,
  19L,        "Jul-94",         1812L,          1L,
  20L,        "Aug-94",         1673L,          3L,
  21L,        "Sep-94",         1575L,          2L,
  22L,        "Oct-94",         1663L,          1L,
  23L,        "Nov-94",         1861L,          5L,
  24L,        "Dec-94",         2058L,          3L,
  25L,        "Jan-95",         2183L,          2L,
  26L,        "Feb-95",         2266L,          7L,
  27L,        "Mar-95",         2289L,          1L,
  28L,        "Apr-95",         2258L,          6L,
  29L,        "May-95",         2143L,          6L,
  30L,        "Jun-95",         2011L,          2L,
  31L,        "Jul-95",         1889L,          4L,
  32L,        "Aug-95",         1780L,          1L,
  33L,        "Sep-95",         1767L,          3L,
  34L,        "Oct-95",         1730L,          4L,
  35L,        "Nov-95",         1535L,          3L,
  36L,        "Dec-95",         1322L,          3L,
  37L,        "Jan-96",         1129L,          0L,
  38L,        "Feb-96",          883L,          1L,
  39L,        "Mar-96",          643L,          0L,
  40L,        "Apr-96",          374L,          0L,
  41L,        "May-96",          185L,          1L,
  42L,        "Jun-96",           28L,          0L,
  43L,        "Jul-96",            0L,          0L,
  44L,        "Aug-96",            0L,          0L,
  45L,        "Sep-96",            0L,          0L,
  46L,        "Oct-96",            0L,          0L,
  47L,        "Nov-96",            0L,          0L,
  48L,        "Dec-96",            0L,          0L,
  49L,        "Jan-97",            0L,          0L,
  50L,        "Feb-97",            0L,          0L,
  51L,        "Mar-97",            0L,          0L,
  52L,        "Apr-97",            0L,          0L,
  53L,        "May-97",           87L,          0L,
  54L,        "Jun-97",          156L,          0L,
  55L,        "Jul-97",          251L,          0L,
  56L,        "Aug-97",          274L,          2L,
  57L,        "Sep-97",          270L,          2L,
  58L,        "Oct-97",          313L,          0L,
  59L,        "Nov-97",          392L,          6L,
  60L,        "Dec-97",          447L,          1L,
  61L,        "Jan-98",          502L,          0L,
  62L,        "Feb-98",          591L,          3L,
  63L,        "Mar-98",          664L,          2L,
  64L,        "Apr-98",          762L,          5L,
  65L,        "May-98",          859L,          3L,
  66L,        "Jun-98",          944L,          3L,
  67L,        "Jul-98",          990L,          4L,
  68L,        "Aug-98",          984L,          1L,
  69L,        "Sep-98",          975L,          1L,
  70L,        "Oct-98",         1050L,          3L,
  71L,        "Nov-98",         1131L,          2L,
  72L,        "Dec-98",         1243L,          6L,
  73L,        "Jan-99",         1300L,          4L,
  74L,        "Feb-99",         1405L,          3L,
  75L,        "Mar-99",         1522L,          4L,
  76L,        "Apr-99",         1638L,          5L,
  77L,        "May-99",         1760L,          4L,
  78L,        "Jun-99",         1846L,          3L,
  79L,        "Jul-99",         1951L,          8L,
  80L,        "Aug-99",         2027L,          1L,
  81L,        "Sep-99",         2018L,          7L,
  82L,        "Oct-99",         2107L,          9L,
  83L,        "Nov-99",         2185L,          9L,
  84L,        "Dec-99",         2273L,         13L,
  85L,        "Jan-00",         2280L,          8L,
  86L,        "Feb-00",         2262L,          7L,
  87L,        "Mar-00",         2213L,          3L,
  88L,        "Apr-00",         2143L,          2L,
  89L,        "May-00",         2053L,          2L,
  90L,        "Jun-00",         1994L,          2L,
  91L,        "Jul-00",         1980L,          2L,
  92L,        "Aug-00",         1969L,          2L,
  93L,        "Sep-00",         1921L,          4L,
  94L,        "Oct-00",         1841L,          1L,
  95L,        "Nov-00",         1776L,          4L,
  96L,        "Dec-00",         1710L,          5L,
  97L,         "1-Jan",         1645L,          3L,
  98L,         "1-Feb",         1570L,          6L,
  99L,         "1-Mar",         1461L,          1L,
  100L,         "1-Apr",         1352L,          3L,
  101L,         "1-May",         1270L,          6L,
  102L,         "1-Jun",         1217L,          3L,
  103L,         "1-Jul",         1196L,          0L,
  104L,         "1-Aug",         1191L,          0L,
  105L,         "1-Sep",         1128L,          6L,
  106L,         "1-Oct",         1021L,          2L,
  107L,         "1-Nov",          926L,          3L,
  108L,         "1-Dec",          840L,          0L,
  109L,         "2-Jan",          780L,          0L,
  110L,         "2-Feb",          738L,          1L,
  111L,         "2-Mar",          749L,          0L,
  112L,         "2-Apr",          730L,          2L,
  113L,         "2-May",          830L,          2L,
  114L,         "2-Jun",          859L,          0L,
  115L,         "2-Jul",          886L,          4L,
  116L,         "2-Aug",          977L,          1L,
  117L,         "2-Sep",         1033L,          0L,
  118L,         "2-Oct",         1166L,          3L,
  119L,         "2-Nov",         1318L,          3L,
  120L,         "2-Dec",         1470L,          5L,
  121L,         "3-Jan",         1559L,          5L,
  122L,         "3-Feb",         1637L,          6L,
  123L,         "3-Mar",         1650L,          3L,
  124L,         "3-Apr",         1696L,          9L,
  125L,         "3-May",         1652L,          8L,
  126L,         "3-Jun",         1698L,          3L,
  127L,         "3-Jul",         1710L,         10L,
  128L,         "3-Aug",         1644L,          4L,
  129L,         "3-Sep",         1629L,          6L,
  130L,         "3-Oct",         1651L,          5L,
  131L,         "3-Nov",         1676L,          7L,
  132L,         "3-Dec",         1690L,          9L,
  133L,         "4-Jan",         1645L,          4L,
  134L,         "4-Feb",         1637L,          2L,
  135L,         "4-Mar",         1643L,          5L,
  136L,         "4-Apr",         1648L,          8L,
  137L,         "4-May",         1619L,          3L,
  138L,         "4-Jun",         1646L,          1L,
  139L,         "4-Jul",         1662L,          1L,
  140L,         "4-Aug",         1651L,          4L,
  141L,         "4-Sep",         1681L,          6L,
  142L,         "4-Oct",         1733L,          7L,
  143L,         "4-Nov",         1775L,          9L,
  144L,         "4-Dec",         1881L,          7L,
  145L,         "5-Jan",         1933L,          7L,
  146L,         "5-Feb",         2013L,          8L,
  147L,         "5-Mar",         2087L,          8L,
  148L,         "5-Apr",         2135L,          9L,
  149L,         "5-May",         2164L,          8L,
  150L,         "5-Jun",         2162L,          3L,
  151L,         "5-Jul",         2170L,          7L,
  152L,         "5-Aug",         2126L,          6L,
  153L,         "5-Sep",         2103L,         11L,
  154L,         "5-Oct",         2118L,          8L,
  155L,         "5-Nov",         2107L,          9L,
  156L,         "5-Dec",         2082L,         13L,
  157L,         "6-Jan",         2021L,          8L,
  158L,         "6-Feb",         1968L,          4L,
  159L,         "6-Mar",         1925L,         15L,
  160L,         "6-Apr",         1838L,          6L,
  161L,         "6-May",         1757L,         14L,
  162L,         "6-Jun",         1691L,          8L,
  163L,         "6-Jul",         1641L,          5L,
  164L,         "6-Aug",         1614L,          6L,
  165L,         "6-Sep",         1525L,          9L,
  166L,         "6-Oct",         1427L,          4L,
  167L,         "6-Nov",         1351L,          6L,
  168L,         "6-Dec",         1300L,          8L,
  169L,         "7-Jan",         1245L,          3L,
  170L,         "7-Feb",         1187L,          8L,
  171L,         "7-Mar",         1125L,          1L,
  172L,         "7-Apr",         1091L,          5L,
  173L,         "7-May",         1028L,          1L,
  174L,         "7-Jun",          931L,          0L,
  175L,         "7-Jul",          892L,          2L,
  176L,         "7-Aug",          801L,          0L,
  177L,         "7-Sep",          718L,          1L,
  178L,         "7-Oct",          639L,          1L,
  179L,         "7-Nov",          561L,          0L,
  180L,         "7-Dec",          499L,          1L
)


table2e2 <- tibble::tribble(
                                        ~`Per-protocol.analyses`, ~Initiators, ~`Non-initiators.(n)`,         ~No.statins1,           ~Statins2,         ~Difference3,         ~No.statins4,            ~Statins5,          ~Difference6,
                             "Main result(Table 3 and Figure 3)",        622L,                232904, "11.2 (10.6, 11.8)",  "8.5 (5.4, 11.1)",  "-2.7 (-5.3, 0.1)", "26.1 (24.8, 27.3)", "21.0 (15.6, 25.7)", "-5.1 (-10.5, -1.1)",
                          "Baseline calendar year 2000 or later",        441L,                146142,  "10.3 (9.5, 11.0)",   "7.1 (5.0, 9.7)", "-3.2 (-5.6, -0.8)", "23.9 (22.4, 25.5)", "20.2 (14.8, 26.0)",   "-3.7 (-9.3, 2.6)",
      "Exclude individuals 70 years of age or older at baseline",        339L,                126228,    "5.9 (5.2, 6.6)",   "5.3 (2.9, 8.4)",  "-0.6 (-3.2, 2.9)", "14.5 (13.3, 16.0)",  "13.0 (7.6, 17.6)",   "-1.5 (-7.4, 3.5)",
  "Restrict to individuals 70 years of age or older at baseline",        283L,                106676, "17.7 (16.6, 18.7)", "13.3 (9.1, 17.8)", "-4.4 (-8.9, -0.4)", "40.4 (38.4, 42.2)", "34.0 (26.9, 41.2)",  "-6.4 (-13.7, 0.6)",
                                        "Rotterdam Study I only",        407L,                172102, "13.0 (12.1, 13.7)",  "9.3 (6.2, 13.2)",  "-3.7 (-6.7, 2.3)", "29.9 (28.3, 31.5)", "22.6 (17.8, 28.7)", "-7.3 (-12.0, -0.7)",
        "Exclude history of heart disease or stroke at baseline",        393L,                190725,   "9.7 (9.1, 10.3)",  "6.6 (3.7, 11.2)", "-3.1 (-6.1, 13.8)", "23.2 (21.9, 24.6)", "16.2 (11.0, 22.8)", "-7.1 (-12.9, -0.1)",
        "Exclude those taking vascular medications* at baseline",        218L,                141329,    "9.1 (8.4, 9.7)",   "5.0 (1.7, 9.2)", "-4.1 (-7.7, -0.2)", "21.8 (20.2, 23.0)",  "15.0 (6.9, 22.6)",  "-6.8 (-15.1, 0.9)",
                        "Exclude high cholesterol (>6.2 mmol/L)",        254L,                140572, "12.1 (11.1, 12.9)", "10.9 (6.6, 15.7)",  "-1.2 (-5.5, 4.2)", "27.2 (25.4, 28.7)", "25.9 (19.8, 33.0)",   "-1.3 (-7.2, 6.3)",
                    "Restrict to high cholesterol (>6.2 mmol/L)",        368L,                 92332,   "9.8 (8.8, 10.7)",  "6.5 (2.9, 11.0)",  "-3.3 (-6.8, 1.0)", "24.3 (22.1, 26.5)", "16.7 (11.3, 22.9)", "-7.6 (-13.6, -1.0)",
                                        "6 month statin washout",        958L,                324426, "10.6 (10.1, 11.2)",  "8.6 (6.4, 10.7)",  "-2.0 (-4.3, 0.3)", "25.0 (24.0, 26.0)", "21.3 (17.4, 25.1)",   "-3.7 (-7.8, 0.1)",
  "MMSE ?26 at baseline but need not be in the previous 3 years",        658L,                246962, "11.2 (10.6, 11.8)",  "8.8 (6.3, 11.3)",  "-2.4 (-4.9, 0.0)", "26.1 (24.7, 27.6)", "21.6 (17.5, 26.0)",   "-4.5 (-8.9, 0.0)"
  )
